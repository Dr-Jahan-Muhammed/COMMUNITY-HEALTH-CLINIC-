<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Community Health Clinic</title>

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

<style>
/* ===== BASE ===== */
*{box-sizing:border-box;}
body{
  margin:0;
  font-family:'Roboto',sans-serif;
  background:#f8fafc;
  color:#111;
  transition: background .3s, color .3s;
}
.dark-mode{background:#0f172a;color:#f1f5f9;}
.dark-mode header{background:#111827;}
.dark-mode .service-card{background:#1f2937;color:#f1f5f9;}
.dark-mode .token-box{background:#1f2937;color:#f1f5f9;}
.dark-mode .token-display{background:#065f46;color:#f1f5f9;}
.dark-mode .dashboard{background:#1f2937;color:#f1f5f9;}

/* ===== WELCOME OVERLAY ===== */
.welcome-overlay{
  position:fixed; inset:0;
  background:rgba(255,255,255,0.92);
  display:flex; flex-direction:column;
  align-items:center; justify-content:center;
  z-index:5000;
  opacity:1; transition:opacity 1s ease;
}
.dark-mode .welcome-overlay{background:rgba(17,24,39,0.95);}
.welcome-overlay.hide{opacity:0; pointer-events:none;}
.welcome-overlay h1{font-size:42px;margin:0;}
.welcome-overlay p{margin-top:10px;font-style:italic;color:#555;}

/* ===== HEADER ===== */
header{
  position:sticky; top:0; z-index:1000;
  background:white; padding:14px;
  text-align:center; transition:.3s; backdrop-filter:blur(10px);
}
header.scrolled{background:rgba(255,255,255,.7);}
.dark-mode header.scrolled{background:rgba(17,24,39,.7);}
.since{font-size:12px;color:#777;}
.clinic-name{font-size:22px;font-weight:700;}
.plus{color:#facc15;font-weight:900;}
.address{font-size:13px;color:#666;}

/* ===== THEME TOGGLE ===== */
.theme-btn{
  position:absolute; right:16px; top:16px;
  padding:6px 12px; border:none;
  border-radius:8px; cursor:pointer;
  background:#2563eb;color:white;
}

/* ===== SECTIONS ===== */
section{padding:20px 16px;}
.section-title{font-size:20px; font-weight:600; margin-bottom:14px;}

/* ===== SERVICES ===== */
.services{display:grid; grid-template-columns:repeat(auto-fit,minmax(120px,1fr)); gap:12px;}
.service-card{
  background:white; padding:14px; border-radius:14px;
  box-shadow:0 4px 10px rgba(0,0,0,.05); text-align:center; font-size:14px;
  display:flex; flex-direction:column; align-items:center;
}
.service-card img{width:40px;margin-bottom:8px;}

/* ===== TOKEN FORM ===== */
.token-box{
  background:white; padding:16px; border-radius:18px; box-shadow:0 8px 20px rgba(0,0,0,.08);
}
.token-box input,.token-box select{
  width:100%; padding:10px; margin-bottom:10px; border-radius:10px; border:1px solid #ddd;
}
.token-box button{width:100%;padding:12px;border:none;border-radius:12px;background:#16a34a;color:white;font-size:16px;}

/* ===== TOKEN DISPLAY ===== */
.token-display{
  margin-top:16px; padding:18px; background:#ecfeff;
  border-radius:18px; text-align:center; position:relative; overflow:hidden;
}
.ribbon{
  position:absolute; top:10px; width:200%; height:6px;
  background:linear-gradient(90deg,#22c55e,#3b82f6,#22c55e);
  animation:ribbon 4s linear infinite;
}
@keyframes ribbon{from{transform:translateX(-50%)} to{transform:translateX(0)}}
.token-number{font-size:42px;font-weight:800;}
.token-date{font-size:14px;color:#555;}
.token-info{margin-top:6px;font-size:14px;}

/* ===== FEEDBACK ===== */
.stars span{font-size:28px; cursor:pointer; color:#ccc;}
.stars span.active{color:#facc15;}
textarea{width:100%; padding:10px; border-radius:12px; border:1px solid #ddd; margin-top:10px;}
.feedback-btn{margin-top:10px; padding:10px; width:100%; border:none; border-radius:12px; background:#2563eb; color:white;}

/* ===== DASHBOARD ===== */
.dashboard{background:white; padding:16px; border-radius:16px; box-shadow:0 6px 16px rgba(0,0,0,.08);}
.dashboard ul{padding-left:16px;}
.dashboard button{margin-top:10px;padding:10px;width:100%;border:none;border-radius:10px;background:#dc2626;color:white;}

/* ===== PDF HIDDEN TOKEN ===== */
#pdfToken{display:none;}

/* ===== HEALTH QUOTES ===== */
#healthQuote{font-style:italic;color:#444;font-size:14px; text-align:center; margin-top:6px;}
.dark-mode #healthQuote{color:#ddd;}
</style>
</head>
<body>

<!-- WELCOME -->
<div id="welcomeOverlay" class="welcome-overlay">
  <h1>WELCOME</h1>
  <p id="welcomeQuote">‚ÄúHealth is the real wealth.‚Äù</p>
</div>

<!-- HEADER -->
<header id="header">
  <div class="since">Since 2003</div>
  <div class="clinic-name">COMMUNITY HEALTH CLINIC <span class="plus">+</span></div>
  <div class="address">Cheenimukku, Poonoor</div>
  <button class="theme-btn" onclick="toggleTheme()">üåô</button>
  <div id="healthQuote">‚ÄúPrevention is better than cure.‚Äù</div>
</header>

<!-- SERVICES -->
<section>
  <div class="section-title">Services</div>
  <div class="services">
    <div class="service-card"><img src="https://img.icons8.com/ios-filled/50/16a34a/stethoscope.png"/>General OP</div>
    <div class="service-card"><img src="https://img.icons8.com/ios-filled/50/16a34a/inhaler.png"/>Nebulisation</div>
    <div class="service-card"><img src="https://img.icons8.com/ios-filled/50/16a34a/heart-with-pulse.png"/>ECG</div>
    <div class="service-card"><img src="https://img.icons8.com/ios-filled/50/16a34a/iv-bag.png"/>IV Fluids</div>
    <div class="service-card"><img src="https://img.icons8.com/ios-filled/50/16a34a/oxygen-tank.png"/>Oxygen</div>
    <div class="service-card"><img src="https://img.icons8.com/ios-filled/50/16a34a/wound.png"/>Wound Management</div>
    <div class="service-card"><img src="https://img.icons8.com/ios-filled/50/16a34a/home.png"/>Home Sample Collection</div>
    <div class="service-card"><img src="https://img.icons8.com/ios-filled/50/16a34a/medical-file.png"/>Minor Procedures</div>
  </div>
</section>

<!-- TOKEN -->
<section>
  <div class="section-title">Take Token (Next Day)</div>
  <div id="nextDayDate" style="margin-bottom:6px;font-weight:600;"></div>
  <div id="liveTokenCount" style="margin-bottom:6px;font-size:14px;color:#555;"></div>
  <div class="token-box">
    <input id="patientName" placeholder="Patient Name">
    <input id="age" type="number" placeholder="Age">
    <select id="sex">
      <option value="">Sex</option>
      <option>Male</option>
      <option>Female</option>
      <option>Other</option>
    </select>
    <input id="mobile" placeholder="Mobile Number">
    <button onclick="takeToken()">Take Token</button>
  </div>
  <div id="tokenResult" class="token-display" style="display:none;">
    <div class="ribbon"></div>
    <div class="token-number" id="tokenNo"></div>
    <div class="token-date" id="tokenDate"></div>
    <div class="token-info" id="tokenInfo"></div>
    <button onclick="downloadToken()">Download PDF</button>
  </div>
</section>

<!-- FEEDBACK -->
<section>
  <div class="section-title">Feedback</div>
  <div class="stars" id="stars">
    <span data-v="1">‚òÖ</span><span data-v="2">‚òÖ</span><span data-v="3">‚òÖ</span><span data-v="4">‚òÖ</span><span data-v="5">‚òÖ</span>
  </div>
  <textarea id="fbText" placeholder="Your feedback"></textarea>
  <button class="feedback-btn" onclick="submitFeedback()">Submit</button>
</section>

<!-- DASHBOARD -->
<section>
  <div class="section-title">Authorized Access</div>
  <input id="pinInput" type="password" placeholder="Enter PIN">
  <button onclick="checkPin()">Enter</button>
  <div id="dashboard" class="dashboard" style="display:none;">
    <h4>Tokens</h4>
    <ul id="tokenList"></ul>
    <h4>Feedback</h4>
    <ul id="feedbackList"></ul>
    <button id="masterBtn" style="display:none;" onclick="clearAll()">Delete All Records</button>
  </div>
</section>

<!-- jsPDF library for PDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
// ===== PINS =====
const VIEW_PIN="1234";
const MASTER_PIN="9999";

// ===== WELCOME FADE =====
document.addEventListener("DOMContentLoaded",()=>{
  const welcomeOverlay=document.getElementById("welcomeOverlay");
  setTimeout(()=>{welcomeOverlay.classList.add("hide");
    setTimeout(()=>welcomeOverlay.style.display="none",1000);
  },2000);

  // Show next-day date
  const nextDay = new Date();
  nextDay.setDate(nextDay.getDate()+1);
  document.getElementById("nextDayDate").textContent = "Next Day: "+nextDay.toDateString();
  updateLiveTokenCount();
});

// ===== HEADER SCROLL =====
const header=document.getElementById("header");
window.addEventListener("scroll",()=>{header.classList.toggle("scrolled",window.scrollY>10);});

// ===== DARK MODE =====
function toggleTheme(){
  document.body.classList.toggle("dark-mode");
}

// ===== TOKEN STORAGE =====
let tokens=JSON.parse(localStorage.getItem("tokens")||"[]");
function updateLiveTokenCount(){
  document.getElementById("liveTokenCount").textContent = "Tokens already taken: "+tokens.length;
}

function takeToken(){
  const pname=document.getElementById("patientName").value.trim();
  const ageVal=document.getElementById("age").value;
  const sexVal=document.getElementById("sex").value;
  const mobileVal=document.getElementById("mobile").value.trim();

  // Check 10 pm
  const now=new Date();
  if(now.getHours()>=22){
    alert("Token cannot be taken after 10 PM");
    return;
  }

  if(!pname||!ageVal||!sexVal||!mobileVal){alert("Fill all details"); return;}
  if(tokens.find(t=>t.name===pname && t.age===ageVal && t.sex===sexVal)){
    alert("Token already taken"); return;
  }

  const no=tokens.length+1;
  const d=new Date(); d.setDate(d.getDate()+1);

  tokens.push({no,name:pname,age:ageVal,sex:sexVal,mobile:mobileVal,date:d.toDateString()});
  localStorage.setItem("tokens",JSON.stringify(tokens));
  updateLiveTokenCount();

  // Display token
  const tokenResult=document.getElementById("tokenResult");
  document.getElementById("tokenNo").textContent="TOKEN "+no;
  document.getElementById("tokenDate").textContent=d.toDateString();
  document.getElementById("tokenInfo").textContent=`${pname}, ${ageVal}/${sexVal}, ${mobileVal}`;
  tokenResult.style.display="block";
}

// ===== PDF TOKEN =====
function downloadToken(){
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF({orientation:"landscape",unit:"px",format:[400,200]});
  const no=document.getElementById("tokenNo").textContent;
  const date=document.getElementById("tokenDate").textContent;
  const info=document.getElementById("tokenInfo").textContent;
  doc.setFillColor(22,163,74); doc.rect(0,0,400,200,"F");
  doc.setFontSize(24); doc.setTextColor(255,255,255); doc.text("COMMUNITY HEALTH CLINIC +",10,30);
  doc.setFontSize(20); doc.text(no,10,70);
  doc.setFontSize(16); doc.text(date,10,100);
  doc.setFontSize(16); doc.text(info,10,130);
  doc.setFontSize(14); doc.text("Cheenimukku, Poonoor",10,160);
  doc.save(no+".pdf");
}

// ===== FEEDBACK =====
let rating=0;
let feedbacks=JSON.parse(localStorage.getItem("feedbacks")||"[]");
const stars=document.getElementById("stars");
stars.querySelectorAll("span").forEach(s=>{
  s.onclick=()=>{
    rating=s.dataset.v;
    stars.querySelectorAll("span").forEach(x=>x.classList.toggle("active",x.dataset.v<=rating));
  };
});
function submitFeedback(){
  if(!rating){alert("Select stars");return;}
  feedbacks.push({rating,text:document.getElementById("fbText").value,time:new Date().toLocaleString()});
  localStorage.setItem("feedbacks",JSON.stringify(feedbacks));
  alert("Thank you!");
  document.getElementById("fbText").value="";
}

// ===== DASHBOARD =====
function checkPin(){
  const pin=document.getElementById("pinInput").value;
  const dashboard=document.getElementById("dashboard");
  const masterBtn=document.getElementById("masterBtn");
  if(pin===VIEW_PIN||pin===MASTER_PIN){
    dashboard.style.display="block";
    masterBtn.style.display=pin===MASTER_PIN?"block":"none";
    loadDashboard();
  } else alert("Invalid PIN");
}

function loadDashboard(){
  const tokenList=document.getElementById("tokenList");
  const feedbackList=document.getElementById("feedbackList");
  tokenList.innerHTML=""; feedbackList.innerHTML="";
  tokens.forEach(t=>{
    const li=document.createElement("li");
    li.textContent=`#${t.no} ${t.name} (${t.age}/${t.sex}) - ${t.mobile} - ${t.date}`;
    tokenList.appendChild(li);
  });
  feedbacks.forEach(f=>{
    const li=document.createElement("li");
    li.textContent=`‚≠ê${f.rating} - ${f.text} (${f.time})`;
    feedbackList.appendChild(li);
  });
}
function clearAll(){
  if(confirm("Delete all records?")){
    localStorage.clear();
    location.reload();
  }
}

// ===== HEALTH QUOTES =====
const quotes=[
  "Health is wealth.",
  "Prevention is better than cure.",
  "A healthy mind in a healthy body.",
  "Take care of your body, it‚Äôs the only place you live.",
  "Healing takes time and patience."
];
let qIndex=0;
setInterval(()=>{
  qIndex=(qIndex+1)%quotes.length;
  document.getElementById("healthQuote").textContent=quotes[qIndex];
  document.getElementById("welcomeQuote").textContent=quotes[qIndex];
},5000);
</script>

</body>
</html>
